{% extends "::base.html.twig" %}

{% block stylesheets %}
    {{ parent() }}
    {% stylesheets 'http://imperavi.com/js/redactor/redactor.css' %}
    	<link href="{{ asset_url }}" rel="stylesheet">
    {% endstylesheets %}

	{% stylesheets '@ShoploAllegroBundle/Resources/public/css/datepicker.css' %}
		<link href="{{ asset_url }}" rel="stylesheet">
	{% endstylesheets %}

    <style type="text/css">
        body .redactor_toolbar li a.redactor_btn_list {
        {% image '@ShoploAllegroBundle/Resources/public/img/shoplo.png' %} background: url({{ asset_url }}) no-repeat;
        {% endimage %}
        }
    </style>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% javascripts 'http://imperavi.com/js/redactor/redactor.js' %}
    	<script src="{{ asset_url }}"></script>
    {% endjavascripts %}

	{% javascripts '@ShoploAllegroBundle/Resources/public/js/bootstrap-datepicker.js' %}
		<script src="{{ asset_url }}"></script>
	{% endjavascripts %}

	{% javascripts '@ShoploAllegroBundle/Resources/public/js/wizard.js' %}
		<script src="{{ asset_url }}"></script>
	{% endjavascripts %}

    <script>
        $(function () {
            $("img[rel=popover]").popover({
                html:true,
                placement:'right',
                trigger:'hover'
            });

            $('.wysiwyg').redactor({
                buttons:['html', '|', 'formatting', '|', 'bold', 'italic', 'deleted', '|', 'unorderedlist', 'orderedlist', 'outdent', 'indent', '|', 'file', 'table', 'link', '|', 'fontcolor', 'backcolor', '|', 'alignment', '|', 'horizontalrule'],
                minHeight:200,
                buttonsAdd:["|", "list"],
                buttonsCustom:{
                    list:{
                        title:"Właściwości produktów z Shoplo",
                        dropdown:{
                            product_name:{
                                title:'Nazwa produktu',
                                callback:function (e) {
                                    e.insertHtml('{product_name}')
                                }
                            },
                            product_short_description:{
                                title:'Opis (krótki)',
                                callback:function (e) {
                                    e.insertHtml('{product_short_description}')
                                }
                            },
                            product_description:{
                                title:'Opis (długi)',
                                callback:function (e) {
                                    e.insertHtml('{product_description}')
                                }
                            },
                            product_sku:{
                                title:'Kod producenta',
                                callback:function (e) {
                                    e.insertHtml('{product_sku}')
                                }
                            },
                            product_price:{
                                title:'Cena',
                                callback:function (e) {
                                    e.insertHtml('{product_price}')
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>
{% endblock %}

{% block body %}
	<div class="container-fluid">
		<div class="row-fluid content">
			<div class="span12">
				<form action="{{ path('shoplo_allegro_wizard', {product: ids}) }}#kategorie" method="post" {{ form_enctype(form) }}>
					<div class="box">
						<h3>Wystaw produkty na Allegro</h3>

						<div class="row-fluid">
							<ul class="inline mini">
							{% for variant in variants %}
								<li>
									<span class="mask">
										<img src="http://src.sencha.io/50/50/{{ variant.thumbnail }}" class="img-rounded" rel="popover"
											 data-content="{% for category in variant.categories %}{{ category.getShoploName() }}{{ "<br>"|e }}{% endfor %}"
											 data-original-title="{{ variant.title }}">
									</span>

									{#<p class="alignCenter">
										<a href="" class="hide action actionDelete"><span class="ico"></span></a>
									</p>#}
								</li>
							{% endfor %}
							</ul>
						</div>
					</div>

                    {#
					<div class="box">
						<h3>Ustawienia aukcji</h3>

						<div class="row-fluid">
							<div class="control-group span4">
								<label class="control-label">Data wystawienia:</label>
								<div class="controls">
									<div class="input-append date" id="dp" data-date="{{"now"|date('d-m-Y')}}" data-date-format="dd-mm-yyyy">
										<input class="span6" size="16" type="text" value="{{"now"|date('d-m-Y')}}" readonly="">
										<span class="add-on"><i class="icon-calendar"></i></span>
									</div>
								</div>
							</div>

							<div class="control-group span4">
								<label for="profile" class="control-label">Pobierz ustawienia z profilu:</label>
								<div class="controls">
									<select name="profile" id="profile">
										<option value="1">Domyślny profil</option>
										<option value="2">Profil promocyjny</option>
										<option value="0">Utwórz nowy profil</option>
										<option value="-1">Bez profilu ustawię recznie</option>
									</select>
								</div>
							</div>
						</div>

						<div class="profile hide">
							<div class="form-inline">
								<div class="control-group">
									<label for="stock-quantity" class="control-label">Liczba sztuk:</label>
									<div class="controls">
										<input type="text" name="quantity" id="stock-quantity" class="span1" value="1" />

										<label class="checkbox">
											<input type="checkbox" name="all-stock" id="all-stock" />
											wszystkie z magazynu
										</label>
									</div>
								</div>
							</div>

							<div class="row-fluid">
								<div class="control-group span3">
									<label for="period" class="control-label">Czas trwania:</label>
									<div class="controls">
										<select name="period" id="period" class="span8">
											<option value="3">3 dni</option>
											<option value="5">5 dni</option>
											<option value="7">7 dni</option>
											<option value="10">10 dni</option>
											<option value="14">14 dni</option>
										</select>
									</div>
								</div>

								<div class="control-group span4">
									<label for="type" class="control-label">Rodzaj aukcji:</label>
									<div class="controls">
										<select name="type" id="type">
											<option value="1">Tylko Kup Teraz</option>
											<option value="2">Tylko licytacja</option>
											<option value="3">Aukcja z licytacją Kup Teraz</option>
										</select>
									</div>
								</div>
							</div>

							<br />

							<h4>Wyróżnienia</h4>

							<div class="row-fluid">
								<div class="control-group span3">
									<div class="controls">
										<label class="checkbox" for="promotionBold">
											<input type="checkbox" class="promotion" name="promotion-bold" id="promotionBold" data-price="2" data-id="1" />
											<span class="title">Pogrubienie</span>
										</label>
									</div>
								</div>

								<div class="control-group span3">
									<div class="controls">
										<label class="checkbox" for="promotionHomePage">
											<input type="checkbox" class="promotion" name="promotion-home-page" id="promotionHomePage" data-price="149" data-id="5" />
											<span class="title">Strona główna</span>
										</label>
									</div>
								</div>

								<div class="control-group span3">
									<div class="controls">
										<label class="checkbox" for="promotionHighlight">
											<input type="checkbox" class="promotion" name="promotion-highlight" id="promotionHighlight" data-price="3" data-id="3" />
											<span class="title">Podświetlenie</span>
										</label>
									</div>
								</div>
							</div>

							<div class="row-fluid">
							<div class="control-group span3">
								<div class="controls">
									<label class="checkbox" for="promotionThumbnail">
										<input type="checkbox" class="promotion" name="promotion-thumbnail" id="promotionThumbnail" data-price="0.2" data-id="4" />
										<span class="title">Miniaturka</span>
									</label>
								</div>
							</div>

							<div class="control-group span3">
								<div class="controls">
									<label class="checkbox" for="promotionDistinction">
										<input type="checkbox" class="promotion" name="promotion-distinction" id="promotionDistinction" data-price="0.2" data-id="2" />
										<span class="title">Wyróżnienie</span>
									</label>
								</div>
							</div>

							<div class="control-group span3">
								<div class="controls">
									<label class="checkbox" for="promotionCategoryPage">
										<input type="checkbox" class="promotion" name="promotion-category-page" id="promotionCategoryPage" data-price="0.2" data-id="6" />
										<span class="title">Strona kategorii</span>
									</label>
								</div>
							</div>
						</div>

							<br />

							<h4>Opcje transportu</h4>

							<div class="row-fluid">
								<div class="control-group span5">
									<div class="controls">
										<label class="checkbox" for="shippingInfo">
											<input type="checkbox" name="shipping-info" id="shippingInfo" />
											Dodatkowe informacje
										</label>
									</div>
								</div>
							</div>

							<div class="row-fluid">
								<div class="control-group span5">
									<div class="controls">
										<label class="checkbox" for="shippingAbroad">
											<input type="checkbox" name="shipping-abroad" id="shippingAbroad" />
											Zgadzam się na wysyłkę za granicę
										</label>
									</div>
								</div>
							</div>

							<br />

							<h4>Formy płatności</h4>

							<div class="row-fluid">
								<div class="control-group span4">
									<div class="controls">
										<label class="checkbox" for="paymentTransfer">
											<input type="checkbox" name="payment-transfer" id="paymentTransfer" />
											Wpłata na konto bankowe
										</label>
									</div>
								</div>
							</div>

							<div class="row-fluid">
								<div class="control-group span4">
									<div class="controls">
										<label class="checkbox" for="paymentPayu">
											<input type="checkbox" name="payment-payu" id="paymentPayu" />
											Płatność PayU
										</label>
									</div>
								</div>
							</div>

							<div class="row-fluid">
								<div class="control-group span4">
									<div class="controls">
										<label class="checkbox" for="paymentOther">
											<input type="checkbox" name="payment-other" id="paymentOther" />
											Inne rodzaje płatności
										</label>
									</div>
								</div>
							</div>

							<div class="row-fluid">
								<div class="control-group span4">
									<div class="controls">
										<label class="checkbox" for="paymentVat">
											<input type="checkbox" name="payment-vat" id="paymentVat" />
											Wystawiam faktury VAT
										</label>
									</div>
								</div>
							</div>
						</div>
					</div>
                    #}

					<div class="box">
						<h3>Wygląd aukcji</h3>

                        {#
						<div class="row-fluid">
							{% for i in range(0,2) %}
							<div class="span1 offset1">
								<p align="center">
									<input type="radio" value="{{ i }}" required="required" name="form[layout]"
										   id="form_layout_{{ i }}"{% if i == 0 %} checked="checked"{% endif %}><br>
									<br>
									<label for="form_layout_{{ i }}">
										{% image '@ShoploAllegroBundle/Resources/public/img/default_theme_screenshot.jpg' %}
										<img src="{{ asset_url }}" alt="Example"/>
										{% endimage %}
									</label>
								</p>
							</div>
							{% endfor %}
							{% do form.layout.setRendered %}
						</div>
						#}

						<div class="row-fluid">
							<div class="control-group">
                                {{ form_label(form.title, 'Tytuł aukcji:') }}
								<div class="controls">
                                    {{ form_widget(form.title, { 'attr': {'class': 'span8', 'placeholder': 'np. Okazja! {product_name} od Super Sprzedawcy!'} }) }}
								</div>
							</div>
						</div>

                        {#
						<div class="form-inline">
							<div class="control-group">
								<label for="price" class="control-label">Cena produktów:</label>
								<div class="controls">
									<select name="price" id="price">
										<option value="1">Tak jak w sklepie</option>
										<option value="2">Powiększona o prowizję Allegro</option>
										<option value="3">Powiększona o</option>
										<option value="4">Pomniejszona o</option>
									</select>

									<input type="text" name="provision" class="span1 hide" />
								</div>
							</div>
						</div>
						#}

						<div class="control-group">
							<label class="control-label">Treść aukcji:</label>
							<div class="controls">
								{{ form_widget(form.description, { 'attr': {'class': 'wysiwyg'} }) }}
							</div>
						</div>
					</div>


					<div class="box">
						<h3>Zdjęcia aukcji</h3>

						<div class="row-fluid">
							<label class="radio">
								<input type="radio" name="imagesOption" id="optionsRadios1" value="all" checked>
								dodaj do aukcji wszystkie zdjęcia produktu
							</label>
							<label class="radio">
								<input type="radio" name="imagesOption" id="optionsRadios2" value="one">
								dodaj do aukcji tylko zdjęcie główne produktu
							</label>

							{#<ul class="inline medium">
								<li>
								<span class="mask alignCenter">
									<a href="">
										<span class="icon icon-plus"></span>Dodaj zdjęcia
									</a>
								</span>
								</li>
								{% for product in products %}
									{% for image in product.images %}
										<li>
											<span class="mask">
												<img src="http://src.sencha.io/140/140/{{ image.src}}" class="img-rounded" rel="popover">
											</span>

											<p class="alignCenter">
												<a href="" class="action actionDelete hide">
													<span class="ico"></span>
												</a>
											</p>
										</li>
									{% endfor %}
								{% endfor %}
							</ul>#}
						</div>

						<br />

						{{ form_rest(form) }}
					</div>


					<div class="box">
						<h3 id="kategorie">Wystaw produkty w kategorii</h3>

						{% for variant in variants %}
							<div class="form-horizontal">
								<div class="control-group">
									<label class="control-label span5">
										<img src="http://src.sencha.io/30/30/{{ variant.thumbnail }}" class="img-rounded">
										{{variant.title}}:&nbsp;&nbsp;
									</label>
									<div class="controls">
										<select name="category[{{variant.id}}]" class="product-category" data-variant-id="{{variant.id}}">
											{% for category in variant.categories %}
											<option value="{{category.getAllegroId()}}" {% if app.request.get('category') and attribute(app.request.get('category'), variant.id) == category.getAllegroId() %} selected="selected"{% endif %}>
                                                {{ category.getAllegroName() }}
                                            </option>
											{% endfor %}
										</select>
									</div>
								</div>
                                {% if attribute(app.request.get('category'), variant.id) is defined %}
                                    {% if attribute(app.request.get('category'), variant.id) is defined %}
                                        {% if attribute(extras, attribute(app.request.get('category'), variant.id)) is defined %}
                                            {% for field in attribute(extras, attribute(app.request.get('category'), variant.id)) %}
                                                <div class="control-group">
                                                    <label class="control-label span5" title="{{ field['title'] }}">
                                                        {{ field['label'] }}:&nbsp;&nbsp;
                                                    </label>
                                                    <div class="controls">
                                                        <select name="extras[{{ variant.id }}][{{ field['id'] }}]">
                                                            {% for value, text in field['options'] %}
                                                                <option value="{{ value }}">{{ text }}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
							</div>
						{% endfor %}
					</div>

					<p class="alignCenter">
						<button class="btn btn-large btn-orange" type="submit">Wystaw na Allegro</button>
					</p>

                    {{ form_rest(form) }}

				</form>
			</div>
            {#
			<div class="span3 box orange summaryBox sidebar">
				<h4>Koszt wystawienia</h4>

				<ul class="unstyled" data-quantity="{{ variants|length }}">
					{% for variant in variants %}
					<li class="row offset1 variant" id="product{{variant.id}}" data-quantity="{% if variant.add_to_magazine%}{{variant.quantity}}{% else %}100{% endif %}">
						<div class="span7 alignRight">
							{{ variant.title }}
						</div>
						<div class="span5 alignRight">
							<span class="quantity">1</span> x <span class="price">{{variant.auction_price}}</span>zł
						</div>
					</li>
					{% endfor %}
					<li class="row offset1" id="promotion1">
						<div class="span7 alignRight">
							Pogrubienie
						</div>
						<div class="span5 alignRight">
							<span class="quantity">25</span> x <span class="price">0,3</span>zł
						</div>
					</li>
				</ul>

				<div class="summary row offset1">
					<div class="span7 alignRight">
						Razem
					</div>
					<div class="span5 alignRight">
						<span class="price-all">{{ total_price|number_format(2, '.', ',') }}</span> zł
					</div>
				</div>
			</div>
            #}
		</div>
	</div>
{% endblock %}
